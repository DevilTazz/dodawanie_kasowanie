<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tile Removal Example</title>
    <style>
      
      .blur-background {
        background-color: lightblue;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
       
        filter: blur(1px);
        opacity: 0.9;
        z-index: -1;
      }

      /* Przycisk do dodawania kafelków */
      #add-tile {
        color: black;
        font-size: 36px;
        cursor: pointer;
        display: flex;
        justify-content: center;
        align-items: center;
        width: 100px;
        height: 100px;
        border-radius: 50%;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.8);
        background-color: #F5F5DC;,
        margin-left: 100px; /* Odstęp od lewej strony */
        margin-right: auto; /* Wyłącz odstęp od prawej strony */
      }

      /* Kontener dla ikon */
      .icon-container {
        position: relative;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: flex-end;
        margin-right: 100px; /* Ustawienie 100px od prawej strony */
        margin-left: 100px; /* Zachowaj odstęp od lewej strony */
      }

      /* Styl pojedynczego kafelka */
      .icon {
        width: 100px;
        height: 100px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.8);
        background-color: green;
        border-radius: 50%;
        display: inline-block;
        
        margin: 20px 0; /* Dodanie przerwy między kafelkami */
        text-align: center;
        position: relative;
        cursor: pointer;
      }

        
        /* Przycisk do usuwania */
      .remove-btn {
        background-color: red;
        color: white;
        border: none;
        cursor: pointer;
        margin-top: 5px;
      }

      /* Kosz */
      #trash {
        width: 50px;
        height: 50px;
        background-image: url('open_trash_test.svg');
        background-size: cover;
        border: 1px solid black;
        margin-top: 20px;
      }

      /* Czarna przerywana linia */
      .separator-line {
        width: 100%; /* Szerokość linii */
        height: 2px; /* Wysokość linii */
        background-color: transparent; 
        border-bottom: 2px dashed black; /* Zmienione na border-bottom, aby zrobić linię poziomą */
        position: absolute;
        top: 50%; /* Ustawienie linii na środku */

      }

      /* Popup z kafelkami do wyboru */
    .popup {
      display: none;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background-color: white;
      padding: 20px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.8);
    }
 
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Sortable/1.15.0/Sortable.min.js"></script>
</head>
<body>  
  <div class="blur-background"></div>

  <!-- Kontener na kafelki -->
  <div class="icon-container" id="sortable-container">    
    <!-- Dodanie przerywanej linii -->
    <div class="separator-line"></div>    
    <!-- Ikony zostaną dodane dynamicznie -->
    <div id="add-tile">+</div>    
  </div>

  <!-- Kosz -->
  <div id="trash"></div>

  <div class="separator-line"></div>

  <!-- Popup z dostępnymi kafelkami -->
  <div id="tile-popup" class="popup">
    <h2>Dodaj kafelek</h2>
    <div id="available-tiles"></div>
  </div>



    <script>
document.addEventListener("DOMContentLoaded", function() {
    const sortableContainer = document.getElementById('sortable-container');
    const trashIcon = document.getElementById('trash');
    const addTileBtn = document.getElementById("add-tile");
    const tilePopup = document.getElementById("tile-popup");

    // Pokaż popup po kliknięciu na przycisk "+"
    addTileBtn.addEventListener("click", function() {
        tilePopup.style.display = 'block'; // Pokaż popup
    });

    // Zamknij popup po kliknięciu poza jego obszarem
    tilePopup.addEventListener('click', function(event) {
        if (event.target === tilePopup) {
            tilePopup.style.display = 'none'; // Ukryj popup
        }
    });

    // Funkcja tworząca kafelek na głównym ekranie
    function createTileForMainScreen(iconSrc, tileId, tileName, tileLink) {
        const tile = document.createElement("div");
        tile.className = "icon";
        tile.innerHTML = `
          <a href="${tileLink}">
            <img src="${iconSrc}" alt="${tileName}">
            <div class="name">${tileName}</div>
          </a>
          <button class="remove-btn" data-tile-id="${tileId}">Usuń</button>
        `;
        tile.id = tileId;
        
        // Dodaj obsługę przeciągania
        tile.setAttribute("draggable", "true");
        tile.addEventListener("dragstart", function(event) {
          event.dataTransfer.setData("text/plain", tileId);
        });

        // Event listener do przycisku usuwania
        tile.querySelector('.remove-btn').addEventListener('click', function() {
          removeTileFromMainScreen(tileId);
        });

        return tile;
    }

    // Funkcja usuwająca kafelek z ekranu głównego
    function removeTileFromMainScreen(tileId) {
        const tileToRemove = document.getElementById(tileId); // Znajdź kafelek po ID
        if (tileToRemove) {
          sortableContainer.removeChild(tileToRemove); // Usuń kafelek z kontenera
          console.log(`Tile with ID ${tileId} removed from main screen.`);
        } else {
          console.error(`Tile with ID ${tileId} not found on the main screen.`);
        }
    }

    // Obsługa przeciągania i upuszczania kafelków na kosz
    trashIcon.addEventListener('dragover', function(event) {
        event.preventDefault(); // Pozwól na upuszczenie
    });

    trashIcon.addEventListener('drop', function(event) {
        event.preventDefault();
        const tileId = event.dataTransfer.getData('text/plain');
        removeTileFromMainScreen(tileId); // Usuwanie kafelka po przeciągnięciu na kosz
    });

    // Fetch and load available tiles from JSON
    fetch('assets/tiles.json')
        .then(response => response.json())
        .then(data => {
            const tileList = document.getElementById('available-tiles');

            // Dodaj dostępne kafelki do popupu
            data.forEach(tile => {
                const tileElement = document.createElement('div');
                tileElement.classList.add('tile-option');
                tileElement.innerHTML = `<img src="${tile.iconUrl}" alt="${tile.name}"> ${tile.name}`;
                
                // Nasłuchiwanie kliknięcia na dany kafelek
                tileElement.addEventListener('click', function() {
                    const newTile = createTileForMainScreen(tile.iconUrl, tile.id, tile.name, tile.link);
                    sortableContainer.appendChild(newTile);

                    // Usuwamy linie zamykającą popup po wyborze kafelka
                });

                tileList.appendChild(tileElement);
            });
        })
        .catch(error => console.error('Error loading tiles:', error));
});
    </script>



</body>
</html>
